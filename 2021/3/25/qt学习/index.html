<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"murmuroftheheart7.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Qt学习笔记 一、qt概述qt（跨平台的C++ GUI应用程序开发框架）——WPS 1. qt发展历史 1991年诞生 1994年创立奇趣科技（Trolltech）公司 2005年qt4.0发布（500+类，9000+函数） 2008年被诺基亚收购 2009年将qt源代码开放 2012年qt被出售给digia公司 2013年5.0发布  2. 相关工具介绍 qt助手&#x2F;&#x2F;帮助手册 qt构建器（qma">
<meta property="og:type" content="article">
<meta property="og:title" content="qt学习">
<meta property="og:url" content="https://murmuroftheheart7.github.io/2021/3/25/qt%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="斜杠青年Felix的博客">
<meta property="og:description" content="Qt学习笔记 一、qt概述qt（跨平台的C++ GUI应用程序开发框架）——WPS 1. qt发展历史 1991年诞生 1994年创立奇趣科技（Trolltech）公司 2005年qt4.0发布（500+类，9000+函数） 2008年被诺基亚收购 2009年将qt源代码开放 2012年qt被出售给digia公司 2013年5.0发布  2. 相关工具介绍 qt助手&#x2F;&#x2F;帮助手册 qt构建器（qma">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://media.giphy.com/media/sOb8nkdTVNWJIQc7Bk/giphy.gif">
<meta property="og:image" content="https://media.giphy.com/media/OuY7156titikZKutdn/giphy.gif">
<meta property="og:image" content="https://media.giphy.com/media/8jT1BdL5nVtOQ9kpuU/giphy.gif">
<meta property="og:image" content="https://media.giphy.com/media/nfrdSprWH7VeO5NhwJ/giphy.gif">
<meta property="og:image" content="https://media.giphy.com/media/CDUyFuherLiVoIoXfE/giphy.gif">
<meta property="og:image" content="https://media.giphy.com/media/sb3Q8NcjyCqppYrlOa/giphy.gif">
<meta property="og:image" content="https://media.giphy.com/media/Gp0mjt5qZq20tp8sYe/giphy.gif">
<meta property="og:image" content="https://media.giphy.com/media/BqusPAxqfHtkBLYe0S/giphy.gif">
<meta property="og:image" content="https://gitee.com/lu-qixin/murmur-ofthe-heart7.gitee.io/rew/master/images/blog/qt%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E7%AB%AF%E5%8F%A3%E5%8F%B7%E6%9F%A5%E8%AF%A21.png">
<meta property="og:image" content="https://gitee.com/lu-qixin/murmur-ofthe-heart7.gitee.io/rew/master/images/blog/qt%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E7%AB%AF%E5%8F%A3%E5%8F%B7%E6%9F%A5%E8%AF%A22.png">
<meta property="og:image" content="https://media.giphy.com/media/YvodmdUJllnMqXAT1Z/giphy.gif">
<meta property="article:published_time" content="2021-03-25T07:14:18.000Z">
<meta property="article:modified_time" content="2021-03-27T12:09:13.857Z">
<meta property="article:author" content="斜杠青年Felix">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://media.giphy.com/media/sOb8nkdTVNWJIQc7Bk/giphy.gif">

<link rel="canonical" href="https://murmuroftheheart7.github.io/2021/3/25/qt%E5%AD%A6%E4%B9%A0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>qt学习 | 斜杠青年Felix的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">斜杠青年Felix的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://murmuroftheheart7.github.io/2021/3/25/qt%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="斜杠青年Felix">
      <meta itemprop="description" content="优秀是一种态度">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="斜杠青年Felix的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          qt学习
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-25 15:14:18" itemprop="dateCreated datePublished" datetime="2021-03-25T15:14:18+08:00">2021-03-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-03-27 20:09:13" itemprop="dateModified" datetime="2021-03-27T20:09:13+08:00">2021-03-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Qt学习笔记"><a href="#Qt学习笔记" class="headerlink" title="Qt学习笔记"></a>Qt学习笔记</h1><hr>
<h2 id="一、qt概述"><a href="#一、qt概述" class="headerlink" title="一、qt概述"></a>一、qt概述</h2><p>qt（跨平台的C++ GUI应用程序开发框架）——WPS</p>
<h4 id="1-qt发展历史"><a href="#1-qt发展历史" class="headerlink" title="1. qt发展历史"></a>1. qt发展历史</h4><ul>
<li>1991年诞生</li>
<li>1994年创立奇趣科技（Trolltech）公司</li>
<li>2005年qt4.0发布（500+类，9000+函数）</li>
<li>2008年被诺基亚收购</li>
<li>2009年将qt源代码开放</li>
<li>2012年qt被出售给digia公司</li>
<li>2013年5.0发布</li>
</ul>
<h4 id="2-相关工具介绍"><a href="#2-相关工具介绍" class="headerlink" title="2. 相关工具介绍"></a>2. 相关工具介绍</h4><ul>
<li>qt助手//帮助手册</li>
<li>qt构建器（qmake）//构建qt应用程序</li>
<li>qt设计师（designer）//图形界面编辑器</li>
<li>qt界面编辑器（uic）//将设计师得到的xml（.ui）文件转换为C++文件（.h）</li>
<li>qt元对象编译器（moc）//将qt中语法扩展还原为标准C++代码</li>
<li>qt资源编译器（rcc）//将图片资源转换为C++文件（.cpp）</li>
<li>qt创造器（qtcreator）//qt的集成开发环境（IDE），包含上面所有工具</li>
</ul>
<h4 id="3-助手中常用的模块"><a href="#3-助手中常用的模块" class="headerlink" title="3. 助手中常用的模块"></a>3. 助手中常用的模块</h4><ul>
<li>qt SQL            //数据库</li>
<li>qt network        //网络</li>
<li>qt widgets        //控件</li>
<li>qt core            //代码</li>
<li>qt GUI            //图形界面</li>
<li>qt serial port    //串口编写</li>
</ul>
<p><strong>例如</strong><br>类名：QApplication/QLabel</p>
<ul>
<li>先看第一句，了解该类的功能，若是不理解，就在”more”中查看详细介绍。</li>
<li>了解头文件（和类名一致），构建选项（QT+=widgets），继承关系。</li>
<li>List of all menbers        //列出所有的函数名</li>
<li>obsolete members        //列出过时的函数，这些函数可能会在以后的版本中删除，同时里面有相应的替换函数</li>
<li>类中的成员变量属性（properties）</li>
<li>公用的成员函数（public functions）</li>
<li>公有虚函数（Reimplemented Public Functions）</li>
<li>槽函数（Public Slots）        //当有个对象发生状态改变，会发射信号，发生某个特定的动作，是qt的语法扩展 </li>
<li>信号函数（signals）</li>
<li>静态公有成员（Static Public Members）        //相当于全局</li>
</ul>
<hr>
<h2 id="第一个qt程序"><a href="#第一个qt程序" class="headerlink" title="第一个qt程序"></a>第一个qt程序</h2><ol>
<li>创建工程目录（最好开头大写）<br>注：每个qt应用程序都应该放在独立的工程目录下</li>
<li>进入工程目录编写代码（C++）</li>
<li>运行前需要qmake（构建）<br>注：需要在Pro里面添加“QT += widgets”</li>
</ol>
<h4 id="qt字符串（QString）和字符编码"><a href="#qt字符串（QString）和字符编码" class="headerlink" title="qt字符串（QString）和字符编码"></a>qt字符串（QString）和字符编码</h4><ol>
<li>常见编码</li>
</ol>
<ul>
<li>Windows默认使用ANSI（中文gbk编码，英文ACKII）</li>
<li>Linux默认使用Unicode（utf-8）</li>
<li>Qt字符串QString内部默认使用Unicode（utf-16）用QString（）将字符串用utf-8来编码</li>
</ul>
<ol start="2">
<li><p>解决字符串乱码——编码转换（QTextCodec）</p>
</li>
<li><p>父窗口（容器窗口）</p>
</li>
</ol>
<ul>
<li>常用的父窗口类<br>  QWidget        //控件基类<br>  QDialog        //对话框，QWidget的子类    //相对简单的界面<br>  QMainWindow    //主窗口，QWidget的子类    //相对复杂的界面</li>
<li>QWidget中两个常用的函数<br>  调整控件或父窗口的位置<br>  void move(int x, int y);    //相对于左上角的位置<br>  调整控制或父窗口的大小<br>  void resize(int w, int h)    //相对于电脑的像素</li>
</ul>
<hr>
<h2 id="二、信号和槽机制"><a href="#二、信号和槽机制" class="headerlink" title="二、信号和槽机制"></a>二、信号和槽机制</h2><h4 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h4><p>  信号和槽是Qt中自定义的一种通信机制，实现对象之间的交互，当某个对象发生改变时将会发送信号，该信号可以被其他对象接收，接收以后将执行一个执行的成员函数（槽函数）。</p>
<h4 id="2-定义"><a href="#2-定义" class="headerlink" title="2. 定义"></a>2. 定义</h4><ul>
<li>包括信号或槽的类必须是Object的子类</li>
<li>信号使用“signals:”标记，信号函数只需声明，不能写定义</li>
<li>槽使用“slots:”标记，槽函数可以与某个信号建立连接，通过某个信号触发槽函数的执行；另外槽函数也可以当做是普通的成员函数，直接调用</li>
<li>包含信号或槽的类，前面需要添加宏“Q_OBJECT”，将来构建工程时，会调用moc（元对象编译器）将语法扩展的信号或槽还原为标准的C++代码。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class XX::public Object&#123;</span><br><span class="line">	Q_OBJECT &#x2F;&#x2F;moc</span><br><span class="line">	signals:</span><br><span class="line">		void sigFunc(void);&#x2F;&#x2F;信号函数</span><br><span class="line">	public slots:</span><br><span class="line">		void slotFunc(void)&#123;…&#125;&#x2F;&#x2F;槽函数</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-信号和槽连接"><a href="#3-信号和槽连接" class="headerlink" title="3. 信号和槽连接"></a>3. 信号和槽连接</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QObject::connect(</span><br><span class="line">const QObject* sender,	    &#x2F;&#x2F;信号发送对象，可以是QObject所有的子类类型</span><br><span class="line">const QObject* signal,		&#x2F;&#x2F;信号函数</span><br><span class="line">const QObject* receiver,	&#x2F;&#x2F;信号的接收对象，可以是QObject所有的子类类型</span><br><span class="line">const QObject*method);	    &#x2F;&#x2F;槽函数</span><br></pre></td></tr></table></figure>
注： SIGNAL（信号函数（参数表））    //将信号函数转换为const char*<br>   SLOT（槽函数（参数表））        //将槽函数转换为const char*<h4 id="4-信号与槽连接的语法要求"><a href="#4-信号与槽连接的语法要求" class="headerlink" title="4. 信号与槽连接的语法要求"></a>4. 信号与槽连接的语法要求</h4></li>
<li>信号和槽参数要一致（绝大多数情况下）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QObject::connect(A,SIGNAL(sigFunc(int)),B,SLOT(slotFunc(int)));&#x2F;&#x2F;ok</span><br><span class="line">QObject::connect(A,SIGNAL(sigFunc(void)),B,SLOT(slotFunc(int)));&#x2F;&#x2F;error</span><br></pre></td></tr></table></figure></li>
<li>可以带有缺省参数，多余参数将被忽略</li>
<li>信号函数的参数可以比槽函数参数多，多余参数将会被忽略</li>
<li>一个信号可以同时连接多个槽函数（一对多）（同一线程上，按顺序执行）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QObject::connect(A,SIGNAL(sigFunc(int)),B1,SLOT(slotFunc1(int)));&#x2F;&#x2F;ok</span><br><span class="line">QObject::connect(A,SIGNAL(sigFunc(int)),B2,SLOT(slotFunc2(int)));&#x2F;&#x2F;ok</span><br></pre></td></tr></table></figure></li>
<li>多个信号可以同时连接到同一个槽函数（多对一）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QObject::connect(A1,SIGNAL(sigFunc1(int)),B,SLOT(slotFunc(int)));&#x2F;&#x2F;ok</span><br><span class="line">QObject::connect(A2,SIGNAL(sigFunc2(int)),B,SLOT(slotFunc(int)));&#x2F;&#x2F;ok</span><br></pre></td></tr></table></figure>
注：无论A1或A2发送信号，B的槽函数都会被执行</li>
<li>两个信号函数可以直接连接（信号串联）//了解<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QObject::connect(A1,SIGNAL(sigFunc1(int)), A2,SIGNAL(sigFunc2(int)));&#x2F;&#x2F;ok</span><br></pre></td></tr></table></figure>
注：当A1发送信号时，所连接的A2对象的信号也将被发送</li>
<li>*A1-&gt;A2-&gt;B**</li>
</ul>
<h4 id="5-QSlider（滑块）-QSpinBox（选值框）"><a href="#5-QSlider（滑块）-QSpinBox（选值框）" class="headerlink" title="5. QSlider（滑块）/QSpinBox（选值框）"></a>5. QSlider（滑块）/QSpinBox（选值框）</h4><p><strong>案例：</strong><br><strong>代码实现</strong><br>main函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;dialog.h&quot;</span><br><span class="line">#include &lt;QApplication&gt;</span><br><span class="line">#include &lt;QLabel&gt;</span><br><span class="line">#include &lt;QPushButton&gt;</span><br><span class="line">#include &lt;QSlider&gt;</span><br><span class="line">#include &lt;QSpinBox&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">    QApplication a(argc, argv);</span><br><span class="line">    Dialog w;</span><br><span class="line">    w.resize(320,240);</span><br><span class="line"></span><br><span class="line">    QLabel label(&quot;我是标签&quot;,&amp;w);</span><br><span class="line">    label.move(20,40);</span><br><span class="line">    QPushButton button(&quot;关闭标签&quot;,&amp;w);</span><br><span class="line">    button.move(20,150);</span><br><span class="line">    QPushButton* abutton &#x3D; new QPushButton(&quot;关闭&quot;,&amp;w);</span><br><span class="line">    abutton-&gt;resize(80,80);</span><br><span class="line">    abutton-&gt;move(200,100);</span><br><span class="line">    QSlider slider(Qt::Horizontal,&amp;w);&#x2F;&#x2F;Qt::Horizontal是个枚举常量，表示滑块是水平的</span><br><span class="line">    slider.move(200,50);</span><br><span class="line">    QSpinBox spin(&amp;w);</span><br><span class="line">    spin.move(150,50);</span><br><span class="line"></span><br><span class="line">    w.show();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;实现点击按钮，关闭标签</span><br><span class="line">    QObject::connect(&amp;button,SIGNAL(clicked()),</span><br><span class="line">            &amp;label,SLOT(close()));</span><br><span class="line">    &#x2F;&#x2F;第一个参数是信号发送对象</span><br><span class="line">    &#x2F;&#x2F;第二个参数是信号函数，用SIGNAL将信号函数转换为const char*格式</span><br><span class="line">    &#x2F;&#x2F;第三个参数是信号接收对象</span><br><span class="line">    &#x2F;&#x2F;第四个参数是槽函数，用SLOT将槽函数转换为const char*格式</span><br><span class="line">    &#x2F;&#x2F;QObject::connect(abutton,SIGNAL(clicked()),&amp;a,SLOT(closeAllWindows()));</span><br><span class="line">    QObject::connect(abutton,SIGNAL(clicked()),&amp;a,SLOT(quit()));</span><br><span class="line">    &#x2F;&#x2F;QObject::connect(abutton,SIGNAL(clicked()),&amp;w,SLOT(close()));</span><br><span class="line">    &#x2F;&#x2F;abutton本身就是指针，所以不需要取地址</span><br><span class="line">    &#x2F;&#x2F;功能实现：将窗口全都关闭</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;滑块滑动时，选值框数值跟随改变</span><br><span class="line">    &#x2F;&#x2F;滑块滑动信号：valueChanged(int)</span><br><span class="line">    &#x2F;&#x2F;设置选值框数值的槽函数：setValue(int)</span><br><span class="line">    QObject::connect(&amp;slider,SIGNAL(valueChanged(int)),&amp;spin,SLOT(setValue(int)));</span><br><span class="line">    &#x2F;&#x2F;选值框数值改变时，滑块随之滑动</span><br><span class="line">    &#x2F;&#x2F;选值框数值改变信号：valueChanged(int)</span><br><span class="line">    &#x2F;&#x2F;设置滑块滑动位置槽函数：setValue(int)</span><br><span class="line">    QObject::connect(&amp;spin,SIGNAL(valueChanged(int)),&amp;slider,SLOT(setValue(int)));</span><br><span class="line"></span><br><span class="line">    return a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/sOb8nkdTVNWJIQc7Bk/giphy.gif" alt="关闭标签/滑动滑块"></p>
<hr>
<h2 id="三、面向对象的Qt编程"><a href="#三、面向对象的Qt编程" class="headerlink" title="三、面向对象的Qt编程"></a>三、面向对象的Qt编程</h2><h4 id="1-基于对象的Qt编程（之前的编写方式）-不推荐"><a href="#1-基于对象的Qt编程（之前的编写方式）-不推荐" class="headerlink" title="1. 基于对象的Qt编程（之前的编写方式）//不推荐"></a>1. 基于对象的Qt编程（之前的编写方式）//不推荐</h4><h4 id="2-面向对象的Qt编程"><a href="#2-面向对象的Qt编程" class="headerlink" title="2. 面向对象的Qt编程"></a>2. 面向对象的Qt编程</h4><p><strong>案例:实现加法计算器</strong><br>QLineEdit（行编辑）</p>
<ul>
<li>左右操作数只能输入数字形式的内容</li>
<li>初始化等号按钮为禁用状态，等到左右操作数都输入有效数据再恢复按钮为正常状态</li>
<li>点击等号按钮时，计算和显示结果<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">思路：</span><br><span class="line">	class CalculatorDialog:public QDialog&#123;</span><br><span class="line">	Q_OBJECT&#x2F;&#x2F;moc</span><br><span class="line">public:</span><br><span class="line">	构造函数（）&#123;界面初始化，信号与槽连接&#125;</span><br><span class="line">public slots：</span><br><span class="line">	void 恢复等号按钮正常状态的槽函数（）&#123;&#125;</span><br><span class="line">	void 计算和显示结果的槽函数（）&#123;&#125;</span><br><span class="line">private:</span><br><span class="line">	QLineEdit、QLabel、QPushButton</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>自定义信号、自定义槽函数<br>signals:            public slots：</li>
</ul>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#ifndef __CALCULATORDIALOG_H</span><br><span class="line">#define __CALCULATORDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QLabel&gt;</span><br><span class="line">#include &lt;QPushButton&gt;</span><br><span class="line">#include &lt;QLineEdit&gt;        &#x2F;&#x2F;行编辑</span><br><span class="line">#include &lt;QDoubleValidator&gt; &#x2F;&#x2F;数字验证器</span><br><span class="line">#include &lt;QFont&gt;            &#x2F;&#x2F;字体</span><br><span class="line">#include &lt;QHBoxLayout&gt;      &#x2F;&#x2F;水平布局器</span><br><span class="line">&#x2F;&#x2F;自定义计算器窗口类</span><br><span class="line">class CalculatorDialog:public QDialog&#123;</span><br><span class="line">    Q_OBJECT                &#x2F;&#x2F;moc</span><br><span class="line">public:</span><br><span class="line">    CalculatorDialog(void); &#x2F;&#x2F;构造函数</span><br><span class="line">public slots:</span><br><span class="line">    void enableButton(void);&#x2F;&#x2F;恢复按钮为正常状态的槽函数</span><br><span class="line">    void calcClicked(void); &#x2F;&#x2F;计算和显示结果的槽函数</span><br><span class="line">private:</span><br><span class="line">    QLineEdit* m_editX;     &#x2F;&#x2F;左操作数</span><br><span class="line">    QLineEdit* m_editY;     &#x2F;&#x2F;右操作数</span><br><span class="line">    QLineEdit* m_editZ;     &#x2F;&#x2F;显示结果</span><br><span class="line">    QLabel* m_label;        &#x2F;&#x2F;“+”标签</span><br><span class="line">    QPushButton* m_button;  &#x2F;&#x2F;“&#x3D;”按钮</span><br><span class="line">    QHBoxLayout* m_layout;  &#x2F;&#x2F;水平布局器，用于自动调整大小和位置</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; __CALCULATORDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CalculatorDialog.h&quot;</span><br><span class="line"></span><br><span class="line">CalculatorDialog::CalculatorDialog(void)&#123;</span><br><span class="line">    setWindowTitle(&quot;加法计算器&quot;);&#x2F;&#x2F;界面初始化</span><br><span class="line">    QFont font;&#x2F;&#x2F;设置字体大小</span><br><span class="line">    font.setPointSize(20);</span><br><span class="line">    setFont(font);</span><br><span class="line"></span><br><span class="line">    m_editX &#x3D; new QLineEdit(this);&#x2F;&#x2F;左操作数，this指向正在创建的对象，就是父窗口指针</span><br><span class="line">    m_editX-&gt;setAlignment(Qt::AlignRight);&#x2F;&#x2F;设置文本对齐方式为右对齐</span><br><span class="line">    m_editX-&gt;setValidator(new QDoubleValidator(this));&#x2F;&#x2F;设置验证器，只能输入数字内容</span><br><span class="line">    m_editY &#x3D; new QLineEdit(this);&#x2F;&#x2F;右操作数</span><br><span class="line">    m_editY-&gt;setAlignment(Qt::AlignRight);</span><br><span class="line">    m_editY-&gt;setValidator(new QDoubleValidator(this));</span><br><span class="line">    m_editZ &#x3D; new QLineEdit(this);&#x2F;&#x2F;显示结果</span><br><span class="line">    m_editZ-&gt;setAlignment(Qt::AlignRight);</span><br><span class="line">    m_editZ-&gt;setReadOnly(true);&#x2F;&#x2F;设置结果为只读，默认为false</span><br><span class="line">    m_label &#x3D; new QLabel(&quot;+&quot;,this);&#x2F;&#x2F;&quot;+&quot;</span><br><span class="line">    m_button &#x3D; new QPushButton(&quot;&#x3D;&quot;,this);</span><br><span class="line">    m_button-&gt;setEnabled(false);&#x2F;&#x2F;设置按钮为禁用（不可点击）</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;使用布局器自动调整控件的大小和位置</span><br><span class="line">    m_layout &#x3D; new QHBoxLayout(this);</span><br><span class="line">    m_layout-&gt;addWidget(m_editX);&#x2F;&#x2F;将控件按水平方向（从左到右）依次添加到布局器</span><br><span class="line">    m_layout-&gt;addWidget(m_label);</span><br><span class="line">    m_layout-&gt;addWidget(m_editY);</span><br><span class="line">    m_layout-&gt;addWidget(m_button);</span><br><span class="line">    m_layout-&gt;addWidget(m_editZ);</span><br><span class="line">    setLayout(m_layout);&#x2F;&#x2F;设置布局器</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;信号和槽连接</span><br><span class="line">    &#x2F;&#x2F;左右操作数文本改变时，发送信号textChanged(QString)</span><br><span class="line">    &#x2F;&#x2F;如果连接的槽函数是当前父窗口中自定义的，那么第三个参数一定是this</span><br><span class="line">    &#x2F;&#x2F;多对一</span><br><span class="line">    &#x2F;&#x2F;信号可以比槽函数的参数多</span><br><span class="line">    connect(m_editX,SIGNAL(textChanged(QString)),this,SLOT(enableButton(void)));</span><br><span class="line">    connect(m_editY,SIGNAL(textChanged(QString)),this,SLOT(enableButton(void)));</span><br><span class="line">    &#x2F;&#x2F;点击等号按钮，发送信号clicked（）</span><br><span class="line">    connect(m_button,SIGNAL(clicked(void)),this,SLOT(calcClicked(void)));</span><br><span class="line"></span><br><span class="line">&#125;&#x2F;&#x2F;构造函数</span><br><span class="line"></span><br><span class="line">void CalculatorDialog::enableButton(void)&#123;</span><br><span class="line">    bool bXok;&#x2F;&#x2F;记录左操作数是否输入了有效数据</span><br><span class="line">    bool bYok;&#x2F;&#x2F;记录右操作数是否输入了有效数据</span><br><span class="line">    m_editX-&gt;text().toDouble(&amp;bXok);</span><br><span class="line">    m_editY-&gt;text().toDouble(&amp;bYok);</span><br><span class="line">    &#x2F;&#x2F;如果左右操作数都输入了有效数据，则恢复按钮为正常可用状态，否则设置为禁用状态</span><br><span class="line">    m_button-&gt;setEnabled(bXok &amp;&amp; bYok);</span><br><span class="line"></span><br><span class="line">&#125;&#x2F;&#x2F;恢复按钮为正常状态槽函数</span><br><span class="line"></span><br><span class="line">void CalculatorDialog::calcClicked(void)&#123;</span><br><span class="line">    double res &#x3D; m_editX-&gt;text().toDouble()+m_editY-&gt;text().toDouble();&#x2F;&#x2F;计算相加结果（转换为double类型进行计算）</span><br><span class="line">    QString str &#x3D; QString::number(res);&#x2F;&#x2F;number（）可以将double转换为QString</span><br><span class="line">    m_editZ-&gt;setText(str);&#x2F;&#x2F;显示结果，setText（）可以设置控件要显示的文本</span><br><span class="line"></span><br><span class="line">&#125;&#x2F;&#x2F;计算和显示结果的槽函数</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/OuY7156titikZKutdn/giphy.gif" alt="加法器"></p>
<hr>
<h2 id="四、qt设计师使用（designer）"><a href="#四、qt设计师使用（designer）" class="headerlink" title="四、qt设计师使用（designer）"></a>四、qt设计师使用（designer）</h2><p>案例：使用设计师重构加法计算器</p>
<ol>
<li><p>创建工程目录</p>
</li>
<li><p>进入工程目录，启动设计师</p>
</li>
</ol>
<ul>
<li>新建窗体</li>
<li>在设计师界面中完成ui设计</li>
<li>从“widget box”中拖拽出相应的控件到父窗口</li>
<li>设置父窗口和每个控件的属性<br>  父窗口：objectname（对象名）<br>  注：将来会根据父窗口的对象名生成一个名字相同的类，包含在设计师完成的所有代码</li>
<li>调整父窗口和控件大小和位置<br>方法一：鼠标拖拽<br>方法二：键盘，调整位置（方向键（一次十个像素），Ctrl+方向键（一次一个像素））<pre><code>        调整大小（shift+方向键（一次十个像素），Ctrl+shift+方向键（一次一个像素））（左上角点不动）</code></pre>
方法三：设置几何属性（geometry），调整位置（x，y）大小（宽度，高度）<br>方法四：使用布局器（右键选择布局）//推荐</li>
</ul>
<ol start="3">
<li>使用界面编辑器（uic），将ui文件转换为C++.h文件</li>
</ol>
<p><strong>ui_*.h文件中的内容</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class CalculatorDialog:public Ui_CaculatorDialog()&#123;</span><br><span class="line">public:</span><br><span class="line">	图形控件相关对象指针声明；</span><br><span class="line">	void setupUi(QDialog*)&#123;&#x2F;&#x2F;界面初始化、创建图形控件、属性设置…&#125;</span><br><span class="line">&#125;;</span><br><span class="line">namespace Ui&#123;</span><br><span class="line">	class CalculatorDialog:public Ui_CalculatorDialog();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注：Ui名称空间的子类（Ui::CalculatorDialog）和上面基类（Ui_CalculatorDialog）相同</p>
<ol start="4">
<li>使用“ui_CaculatorDialog.h”文件，复用里面代码方法</li>
</ol>
<ul>
<li>方法1：继承<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	class MyClass:public Ui::CalculatorDialog&#123;</span><br><span class="line">&#x2F;&#x2F;将界面相关代码继承过来直接使用</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>方法2：组合<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	class MyClass&#123;</span><br><span class="line">public:</span><br><span class="line">	MyClass():ui(new Ui::CalculatorDialog)&#123;&#125;</span><br><span class="line">private:</span><br><span class="line">	Ui::CalculatorDialog* ui;&#x2F;&#x2F;之后可以通过“ui-&gt;”访问和界面相关代码</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>*案例：登录对话框**</li>
<li>创建工程目录</li>
<li>进入工程目录，启动设计师，完成ui设计<br>  echoMode：    Password//用密码的方式显示文本<br>layoutDirection:    LeftToRight//改为从左向右的布局方式</li>
</ul>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#ifndef __LOGINDIALOG_H</span><br><span class="line">#define __LOGINDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &quot;ui_LoginDialog.h&quot;</span><br><span class="line">#include &lt;QMessageBox&gt;&#x2F;&#x2F;消息提示框</span><br><span class="line">#include &lt;QDebug&gt;&#x2F;&#x2F;打印调试</span><br><span class="line"></span><br><span class="line">namespace Ui &#123;</span><br><span class="line">class LoginDialog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class LoginDialog : public QDialog,public Ui::LoginDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    LoginDialog(void);</span><br><span class="line">    ~LoginDialog();</span><br><span class="line">public slots:</span><br><span class="line">    void onAccepted(void);&#x2F;&#x2F;处理ok按钮的槽函数</span><br><span class="line">    void onRejected(void);&#x2F;&#x2F;处理Cancel按钮的槽函数</span><br><span class="line">    &#x2F;&#x2F;点击也分为很多种，最普通的就是clicked()，但是对于有明确接受与拒绝信号的按钮，我们可以用accepted()和rejected()来表示相应的点击</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    Ui::LoginDialog *ui;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; __LOGINDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;LoginDialog.h&quot;</span><br><span class="line"></span><br><span class="line">LoginDialog::LoginDialog(void)&#123;</span><br><span class="line">    setupUi(this);</span><br><span class="line">    connect(m_btnBox,SIGNAL(accepted()),this,SLOT(onAccepted()));</span><br><span class="line">    connect(m_btnBox,SIGNAL(rejected()),this,SLOT(onRejected()));</span><br><span class="line"></span><br><span class="line">&#125;&#x2F;&#x2F;构造函数</span><br><span class="line"></span><br><span class="line">void LoginDialog::onAccepted()&#123;</span><br><span class="line">    &#x2F;&#x2F;如果属于tarena&#x2F;123456打印提示登录成功，如果不是，弹出消息框显示登录失败</span><br><span class="line">    if(m_editUserName-&gt;text()&#x3D;&#x3D;&quot;tarena&quot; &amp;&amp; m_editPassword-&gt;text()&#x3D;&#x3D;&quot;123456&quot;)&#123;</span><br><span class="line">        qDebug(&quot;登陆成功&quot;);&#x2F;&#x2F;相当于printf</span><br><span class="line">        qDebug() &lt;&lt; &quot;Login Success!&quot;;&#x2F;&#x2F;相当于cout</span><br><span class="line">        close();&#x2F;&#x2F;关闭登录对话框</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        QMessageBox msgBox(QMessageBox::Critical,&quot;登录失败&quot;,&quot;用户名或密码错误，请重试！&quot;,QMessageBox::Ok,this);</span><br><span class="line">        &#x2F;&#x2F;参数：图标，标题，提示信息，按钮，父窗口</span><br><span class="line">        msgBox.exec();&#x2F;&#x2F;显示消息提示框，并进入事件循环</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;&#x2F;&#x2F;处理ok按钮的槽函数</span><br><span class="line"></span><br><span class="line">void LoginDialog::onRejected()&#123;</span><br><span class="line">    &#x2F;&#x2F;弹出消息提示框，提示用户是否确定要取消登录</span><br><span class="line">    QMessageBox msgBox(QMessageBox::Question,&quot;取消登录&quot;,&quot;确定要取消登录么？&quot;,QMessageBox::No|QMessageBox::Yes);</span><br><span class="line">    &#x2F;&#x2F;显示消息提示框，并进入事件循环，点击No或Yes都会退出事件循环；点击Yes退出时，关闭登录对话框</span><br><span class="line">    if(msgBox.exec() &#x3D;&#x3D; QMessageBox::Yes)&#123;</span><br><span class="line">        close();&#x2F;&#x2F;关闭登录对话框</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;&#x2F;&#x2F;处理cancel按钮的槽函数</span><br><span class="line"></span><br><span class="line">LoginDialog::~LoginDialog()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/8jT1BdL5nVtOQ9kpuU/giphy.gif" alt="登录对话框"></p>
<hr>
<h2 id="五、Qt创造器使用（qtcreator）"><a href="#五、Qt创造器使用（qtcreator）" class="headerlink" title="五、Qt创造器使用（qtcreator）"></a>五、Qt创造器使用（qtcreator）</h2><p><strong>使用技巧</strong><br>F4可以实现在头文件与源文件之间快速切换<br>对象用.<br>对象指针用-&gt;<br>QString str;<br>qDebug() &lt;&lt; str;//类似C++的信息流，打印消息到通知栏</p>
<p><strong>案例：获取系统时间</strong></p>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#ifndef __timeDIALOG_H</span><br><span class="line">#define __timeDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QLabel&gt;</span><br><span class="line">#include &lt;QPushButton&gt;</span><br><span class="line">#include &lt;QVBoxLayout&gt;&#x2F;&#x2F;垂直布局器</span><br><span class="line">#include &lt;QFont&gt;</span><br><span class="line">#include &lt;QDateTime&gt;</span><br><span class="line"></span><br><span class="line">class TimeDialog:public QDialog&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">public:</span><br><span class="line">    TimeDialog(void);</span><br><span class="line">public slots:</span><br><span class="line">    void getTimeButton(void);</span><br><span class="line">private:</span><br><span class="line">    QLabel* m_label;</span><br><span class="line">    QPushButton* m_button;</span><br><span class="line">    QVBoxLayout* m_layout;</span><br><span class="line">    QDateTime m_time;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; __timeDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;timedialog.h&quot;</span><br><span class="line"></span><br><span class="line">TimeDialog::TimeDialog(void)&#123;</span><br><span class="line">    setWindowTitle(&quot;时间&quot;);</span><br><span class="line">    QFont font;</span><br><span class="line">    font.setPointSize(20);</span><br><span class="line">    setFont(font);</span><br><span class="line"></span><br><span class="line">    m_label &#x3D; new QLabel(this);</span><br><span class="line">    m_label-&gt;setFrameStyle(QFrame::Panel|QFrame::Sunken);&#x2F;&#x2F;设置边框效果：凹陷面板</span><br><span class="line">    m_label-&gt;setAlignment(Qt::AlignHCenter|Qt::AlignVCenter);&#x2F;&#x2F;设置文本水平居中对齐且垂直居中对齐</span><br><span class="line">    m_button &#x3D; new QPushButton(&quot;获取系统时间&quot;,this);</span><br><span class="line"></span><br><span class="line">    connect(m_button,SIGNAL(clicked(void)),this,SLOT(getTimeButton(void)));</span><br><span class="line">    m_layout &#x3D; new QVBoxLayout(this);</span><br><span class="line">    m_layout-&gt;addWidget(m_label);</span><br><span class="line">    m_layout-&gt;addWidget(m_button);</span><br><span class="line">    setLayout(m_layout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void TimeDialog::getTimeButton(void)&#123;</span><br><span class="line">    m_time&#x3D;QDateTime::currentDateTime();</span><br><span class="line">    QString str&#x3D;m_time.toString(&quot;yyyy-MM-dd hh:mm:ss ddd&quot;);</span><br><span class="line">    m_label-&gt;setText(str);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/nfrdSprWH7VeO5NhwJ/giphy.gif" alt="获取系统时间"></p>
<hr>
<h2 id="六、资源和图像"><a href="#六、资源和图像" class="headerlink" title="六、资源和图像"></a>六、资源和图像</h2><ol>
<li>资源编译器（rcc）</li>
</ol>
<ul>
<li>创建资源文件（.qrc）</li>
<li>将资源文件中描述的图片资源编辑器转换为C++源代码</li>
</ul>
<p>2.绘图事件（paintEvent）和画家类（QPainter）</p>
<ul>
<li>当应用程序窗口改变时（启动，拉伸，拖拽，最大化最小化…）将会触发绘图事件，对应的事件处理函数paintEvent将会被执行。<br>virtual void QWidget::paintEvent(QPaintEvent*);</li>
<li>通过调用update()/repaint()函数也可以手动触发绘图事件</li>
<li>绘图事件处理函数是虚函数，如果希望在自定义子类中实现指定的图像绘制，可以重写绘图事件处理函数，对基类中的版本形成覆盖，并在其中通过画家类完成绘制操作。</li>
<li>QPainter是Qt中二维图形引擎，可以实现各种图像、图片的绘制。</li>
</ul>
<p><strong>案例：图图秀</strong></p>
<ol>
<li>使用qt创造器创建工程</li>
</ol>
<ul>
<li>工程名：ShowImage</li>
<li>类名：ShowImageDialog</li>
</ul>
<ol start="2">
<li>向工程中添加资源</li>
</ol>
<ul>
<li>将需要使用资源图片（images）拷贝到工程目录下</li>
<li>添加新文件：qt-》qt resource file</li>
<li>指定资源文件名字：showImage（将来会自动生成showImage.qrc的资源文件）</li>
<li>下一步完成，默认进入文件编辑界面</li>
<li>添加：添加前缀-》添加文件，选择“image”目录下的所有图片并打开</li>
</ul>
<ol start="3">
<li>双击.ui文件，进入设计模式，完成界面设计</li>
</ol>
<ul>
<li>拖拽需要使用的控件<br>frame（显示框架）pushbutton（实现图片上一张下一张的切换）</li>
<li>设置属性<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">frame：</span><br><span class="line">	sizePolicy:垂直策略（Expanding）&#x2F;&#x2F;让控件在设置布局的过程中，尽可能的多占据空间，而不是跟其他的控件平均分配空间</span><br><span class="line">	FrameShape:Box&#x2F;&#x2F;一种窗口的显示主题</span><br></pre></td></tr></table></figure></li>
<li>使用布局器调整大小和位置</li>
</ul>
<ol start="4">
<li>编码、测试</li>
</ol>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#ifndef DIALOGSHOWIMAGEDIALOG_H</span><br><span class="line">#define DIALOGSHOWIMAGEDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QImage&gt;&#x2F;&#x2F;图片对象</span><br><span class="line">#include &lt;QPainter&gt;&#x2F;&#x2F;画家类</span><br><span class="line"></span><br><span class="line">namespace Ui &#123;</span><br><span class="line">class DialogShowImageDialog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DialogShowImageDialog : public QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    explicit DialogShowImageDialog(QWidget *parent &#x3D; nullptr);</span><br><span class="line">    ~DialogShowImageDialog();</span><br><span class="line"></span><br><span class="line">private slots:</span><br><span class="line">    void on_m_btnPrev_clicked();</span><br><span class="line"></span><br><span class="line">    void on_m_btnNext_clicked();</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    void paintEvent(QPaintEvent *);&#x2F;&#x2F;绘图事件处理函数，窗口改变会自动运行或者调用update触发运行</span><br><span class="line">private:</span><br><span class="line">    Ui::DialogShowImageDialog *ui;</span><br><span class="line">    int m_index;&#x2F;&#x2F;图片索引</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; DIALOGSHOWIMAGEDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;dialogshowimagedialog.h&quot;</span><br><span class="line">#include &quot;ui_dialogshowimagedialog.h&quot;</span><br><span class="line"></span><br><span class="line">DialogShowImageDialog::DialogShowImageDialog(QWidget *parent) :</span><br><span class="line">    QDialog(parent),</span><br><span class="line">    ui(new Ui::DialogShowImageDialog)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;setupUi(this);</span><br><span class="line">    m_index &#x3D; 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DialogShowImageDialog::~DialogShowImageDialog()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;自动生成上一张按钮的槽函数</span><br><span class="line">void DialogShowImageDialog::on_m_btnPrev_clicked()&#123;</span><br><span class="line"></span><br><span class="line">    if(--m_index &lt; 0)&#123;</span><br><span class="line">        m_index&#x3D;3;</span><br><span class="line">    &#125;</span><br><span class="line">    update();&#x2F;&#x2F;触发绘图事件</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;下一张</span><br><span class="line">void DialogShowImageDialog::on_m_btnNext_clicked()&#123;</span><br><span class="line"></span><br><span class="line">    if(++m_index &gt; 3)&#123;</span><br><span class="line">        m_index &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">    update();</span><br><span class="line">&#125;</span><br><span class="line">void DialogShowImageDialog::paintEvent(QPaintEvent *)&#123;</span><br><span class="line"></span><br><span class="line">    QPainter painter(this);                 &#x2F;&#x2F;创建画家对象</span><br><span class="line">    QRect rect &#x3D; ui-&gt;frame-&gt;frameRect();    &#x2F;&#x2F;获取绘图的矩形区域,QRrect表示矩形区域的对象</span><br><span class="line">    rect.translate(ui-&gt;frame-&gt;pos());       &#x2F;&#x2F;平移rect坐标值，让其和父窗口（painter）坐标系一致</span><br><span class="line">    &#x2F;&#x2F;准备绘制的图片对象，QImage表示图片对象,&quot;:&#x2F;new&#x2F;prefix1&#x2F;images&#x2F;&quot;为路径名(千万不要打错路径，打错路径后并不会报错，但是不会显示图片)</span><br><span class="line">    QImage image(&quot;:&#x2F;new&#x2F;prefix1&#x2F;images&#x2F;&quot;+QString::number(m_index)+&quot;.png&quot;);</span><br><span class="line">    painter.drawImage(rect,image);          &#x2F;&#x2F;使用painter将image绘制到rect上</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/CDUyFuherLiVoIoXfE/giphy.gif" alt="图图秀"></p>
<hr>
<h2 id="七、目录（QDir）和定时器（QTime）"><a href="#七、目录（QDir）和定时器（QTime）" class="headerlink" title="七、目录（QDir）和定时器（QTime）"></a>七、目录（QDir）和定时器（QTime）</h2><ol>
<li>目录QDir</li>
</ol>
<ul>
<li>创建目录对象<br>  QDir dir(“/home/tarena/csd1911/qt/photos”);//绝对路径<br>  QDir dir(“./photos”);//相对路径</li>
<li>遍历目录下内容<br>  QStringList list1 = dir.entryList(QDir::dirs|QDir::NoDotAndDotDot);//遍历子目录，并且排除.与..目录<br>  QStringList list1 = dir.entryList(QDir::Files);//遍历普通文件</li>
</ul>
<ol start="2">
<li>定时器</li>
</ol>
<ul>
<li><p>定时器事件：timerEvent<br>//定时器事件处理函数，定时器到时后将自动触发执行<br>virtual void timeEvent(QTimerEvent*);<br>//开启定时器，参数定时器到时的间隔时间（ms，是连续触发的，所以需要关闭），返回定时器ID<br>int startTimer(int interval);<br>//关闭定时器<br>void killTimer(int id);</p>
</li>
<li><p>定时器类：QTimer（对上一个事件进行封装）(实现循环操作，相当于while（1），但是while会使窗口卡死)（比定时器事件更灵活）<br>//创建定时器对象<br>QTimer timer;<br>//连接定时器信号和槽函数<br>connect(&amp;timer,SIGNAL(timeout()),this,SLOT(自定义定时器处理槽函数()));<br>//开启定时器<br>timer.start(int msec);<br>//关闭定时器<br>timer.stop();</p>
</li>
</ul>
<p><strong>案例：摇摇乐</strong></p>
<ul>
<li>工程名：Lottery</li>
<li>类名：LotteryDialog</li>
<li>将“photos”目录拷贝到工程目录下，然后到qt创造器的“项目”模式中，去掉Shadow build选项（因为要用相对路径）</li>
<li>双击“.ui”文件，进入设计模式，完成ui设计</li>
</ul>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#ifndef LOTTERYDIALOG_H</span><br><span class="line">#define LOTTERYDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QPainter&gt; &#x2F;&#x2F;画家</span><br><span class="line">#include &lt;QDir&gt;     &#x2F;&#x2F;目录</span><br><span class="line">#include &lt;QTimer&gt;   &#x2F;&#x2F;定时器</span><br><span class="line">#include &lt;QTime&gt;    &#x2F;&#x2F;时间</span><br><span class="line">#include &lt;QVector&gt;  &#x2F;&#x2F;向量容器</span><br><span class="line">#include &lt;QDebug&gt;   &#x2F;&#x2F;打印调试</span><br><span class="line"></span><br><span class="line">namespace Ui &#123;</span><br><span class="line">class LotteryDialog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class LotteryDialog : public QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    explicit LotteryDialog(QWidget *parent &#x3D; nullptr);</span><br><span class="line">    ~LotteryDialog();</span><br><span class="line"></span><br><span class="line">private slots:</span><br><span class="line">    void on_pushButton_clicked();</span><br><span class="line">    void onTimeout(void);                   &#x2F;&#x2F;定时器到时后执行的槽函数</span><br><span class="line">private:</span><br><span class="line">    void loadPhotos(const QString&amp; path);   &#x2F;&#x2F;从参选者目录中加载照片到容器中</span><br><span class="line">    &#x2F;&#x2F;void timerEvent(QTimerEvent *);       &#x2F;&#x2F;定时器事件处理函数</span><br><span class="line">    void paintEvent(QPaintEvent *);         &#x2F;&#x2F;绘图事件处理函数</span><br><span class="line">private:</span><br><span class="line">    Ui::LotteryDialog *ui;</span><br><span class="line">    QVector&lt;QImage&gt; m_vecPhotos;            &#x2F;&#x2F;保存所有参选者照片的容器(相当于动态数组）</span><br><span class="line">    int m_index;                            &#x2F;&#x2F;照片在容器中索引</span><br><span class="line">    QTimer m_timer;                         &#x2F;&#x2F;int m_timer;&#x2F;&#x2F;定时器ID</span><br><span class="line">    bool isStarted;                         &#x2F;&#x2F;状态标记，true（开始摇奖），false（停止摇奖）</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; LOTTERYDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;lotterydialog.h&quot;</span><br><span class="line">#include &quot;ui_lotterydialog.h&quot;</span><br><span class="line"></span><br><span class="line">LotteryDialog::LotteryDialog(QWidget *parent) :</span><br><span class="line">    QDialog(parent),</span><br><span class="line">    ui(new Ui::LotteryDialog)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;setupUi(this);</span><br><span class="line">    isStarted &#x3D; false;                      &#x2F;&#x2F;初始化未开始摇奖</span><br><span class="line">    m_index &#x3D; 0;                            &#x2F;&#x2F;初始化索引号</span><br><span class="line">    qsrand(QTime::currentTime().msec());    &#x2F;&#x2F;设置随机数种子</span><br><span class="line">    loadPhotos(&quot;.&#x2F;photos&quot;);                 &#x2F;&#x2F;动态的从photos目录加载图片，注意路径</span><br><span class="line">    qDebug() &lt;&lt; &quot;加载到照片个数：&quot; &lt;&lt; m_vecPhotos.size();</span><br><span class="line">    &#x2F;&#x2F;定时器到时后将会发送信号timeout</span><br><span class="line">    connect(&amp;m_timer,SIGNAL(timeout()),this,SLOT(onTimeout()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LotteryDialog::~LotteryDialog()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;开始按钮对应的槽函数</span><br><span class="line">void LotteryDialog::on_pushButton_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    if(isStarted &#x3D;&#x3D; false)&#123;</span><br><span class="line">        isStarted &#x3D; true;&#x2F;&#x2F;开始摇奖</span><br><span class="line">        ui-&gt;pushButton-&gt;setText(&quot;停止摇奖&quot;);  &#x2F;&#x2F;修改按钮文本</span><br><span class="line">        &#x2F;&#x2F;m_timer &#x3D; startTimer(50);         &#x2F;&#x2F;开始定时器，每隔50ms触发一次</span><br><span class="line">        m_timer.start(50);</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        isStarted &#x3D; false;                  &#x2F;&#x2F;停止摇奖</span><br><span class="line">        ui-&gt;pushButton-&gt;setText(&quot;开始摇奖&quot;);</span><br><span class="line">        &#x2F;&#x2F;killTimer(m_timer);               &#x2F;&#x2F;关闭定时器</span><br><span class="line">        m_timer.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;从参选者目录中加载照片到容器中</span><br><span class="line">void LotteryDialog::loadPhotos(const QString&amp; path)&#123;</span><br><span class="line">    QDir dir(path);&#x2F;&#x2F;创建目录对象</span><br><span class="line">    &#x2F;&#x2F;遍历访问当前目录下所有照片</span><br><span class="line">    QStringList l1 &#x3D; dir.entryList(QDir::Files);</span><br><span class="line">    for (int i&#x3D;0;i&lt;l1.size();i++) &#123;</span><br><span class="line">        QImage image(path+&quot;&#x2F;&quot;+l1.at(i));    &#x2F;&#x2F;根据照片文件名字构造图片对象</span><br><span class="line">        m_vecPhotos &lt;&lt; image;               &#x2F;&#x2F;保存照片到容器中</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;递归偏离子目录下的所有照片,不包括“.”和“..”</span><br><span class="line">    QStringList l2 &#x3D; dir.entryList(QDir::Dirs|QDir::NoDotAndDotDot);</span><br><span class="line">    for (int i&#x3D;0;i&lt;l2.size();i++) &#123;</span><br><span class="line">        loadPhotos(path+&quot;&#x2F;&quot;+l2.at(i));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;定时器事件处理函数（每次定时器到时都会自动被触发执行）</span><br><span class="line">&#x2F;*void LotteryDialog::timerEvent(QTimerEvent *)&#123;</span><br><span class="line">    &#x2F;&#x2F;随机从容器中获取一个照片对象的索引</span><br><span class="line">    m_index &#x3D; qrand()%m_vecPhotos.size();</span><br><span class="line">    &#x2F;&#x2F;触发绘图事件，绘制m_index对应的照片</span><br><span class="line">    update();</span><br><span class="line">&#125;*&#x2F;</span><br><span class="line">&#x2F;&#x2F;定时器到时后执行的槽函数</span><br><span class="line">void LotteryDialog::onTimeout(void)&#123;</span><br><span class="line">    m_index &#x3D; qrand()%m_vecPhotos.size();   &#x2F;&#x2F;随机从容器中获取一个照片对象的索引</span><br><span class="line">    update();                               &#x2F;&#x2F;触发绘图事件，绘制m_index对应的照片</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;绘图事件处理函数</span><br><span class="line">void LotteryDialog::paintEvent(QPaintEvent *)&#123;</span><br><span class="line">    QPainter painter(this);&#x2F;&#x2F;创建绘图的画家对象</span><br><span class="line">    QRect rect &#x3D; ui-&gt;frame-&gt;frameRect();            &#x2F;&#x2F;绘图的矩形区域</span><br><span class="line">    rect.translate(ui-&gt;frame-&gt;pos());               &#x2F;&#x2F;坐标值平移，让其和painter坐标系一致</span><br><span class="line">    painter.drawImage(rect,m_vecPhotos[m_index]);   &#x2F;&#x2F;绘制m_index对应的照片</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/sb3Q8NcjyCqppYrlOa/giphy.gif" alt="抽奖效果"></p>
<hr>
<h2 id="八、鼠标和键盘"><a href="#八、鼠标和键盘" class="headerlink" title="八、鼠标和键盘"></a>八、鼠标和键盘</h2><ol>
<li>鼠标事件<br>#include &lt;QMouseEvent&gt;<br>//鼠标按下时执行的事件处理函数<br>virtual void mousePressEvent(QMouseEvent *);<br>//鼠标抬起时执行的事件处理函数<br>virtual void mouseReleaseEvent(QMouseEvent *);<br>//鼠标移动时执行的事件处理函数<br>virtual void mouseMoveEvent(QMouseEvent *);<br>//鼠标双击时执行的事件处理函数<br>virtual void mouseDoubleClickEvent(QMouseEvent *);<br>QRect(x,y,w,h);//矩形区域<br>QPoint(x,y);//位置<br>QSize(w,h);//大小</li>
</ol>
<p><strong>案例：鼠标测试，实现用鼠标左键拖拽“标签”移动</strong></p>
<ul>
<li>工程名：Mouse</li>
<li>类名：MouseDialog</li>
<li>界面设计：设置label控件背景颜色<br>方法1：样式表（styleSheet）<br>方法2：调色板（palette）（只能二选一）<br>  autoFillBackground:勾选<br>  palette：点击“继承”-&gt;“改变调色板”<br>  编辑调色板：选择颜色</li>
</ul>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#ifndef MOUSEDIALOG_H</span><br><span class="line">#define MOUSEDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QMouseEvent&gt;</span><br><span class="line"></span><br><span class="line">namespace Ui &#123;</span><br><span class="line">class MouseDialog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MouseDialog : public QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    explicit MouseDialog(QWidget *parent &#x3D; nullptr);</span><br><span class="line">    ~MouseDialog();</span><br><span class="line">private:</span><br><span class="line">    void mousePressEvent(QMouseEvent *event);    &#x2F;&#x2F;鼠标按下时执行的事件处理函数</span><br><span class="line">    void mouseReleaseEvent(QMouseEvent *event);  &#x2F;&#x2F;鼠标抬起时执行的事件处理函数</span><br><span class="line">    void mouseMoveEvent(QMouseEvent *event);     &#x2F;&#x2F;鼠标移动时执行的事件处理函数</span><br><span class="line">private:</span><br><span class="line">    Ui::MouseDialog *ui;</span><br><span class="line">    bool m_drag;        &#x2F;&#x2F;标记是否可以拖拽</span><br><span class="line">    QPoint m_pos;       &#x2F;&#x2F;记录鼠标和label的相对位置</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; MOUSEDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;mousedialog.h&quot;</span><br><span class="line">#include &quot;ui_mousedialog.h&quot;</span><br><span class="line"></span><br><span class="line">MouseDialog::MouseDialog(QWidget *parent) :</span><br><span class="line">    QDialog(parent),</span><br><span class="line">    ui(new Ui::MouseDialog)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;setupUi(this);</span><br><span class="line">    m_drag &#x3D; false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MouseDialog::~MouseDialog()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;鼠标按下时执行的事件处理函数</span><br><span class="line">void MouseDialog::mousePressEvent(QMouseEvent *event)&#123;</span><br><span class="line"></span><br><span class="line">    if(event-&gt;button() &#x3D;&#x3D; Qt::LeftButton)&#123;              &#x2F;&#x2F;是否为鼠标左键按下,event-&gt;button()读取目前按下的按键，验证是否是左键</span><br><span class="line">        QRect rect &#x3D; ui-&gt;label-&gt;frameRect();            &#x2F;&#x2F;获取label所在矩形区域</span><br><span class="line">        rect.translate(ui-&gt;label-&gt;pos());               &#x2F;&#x2F;坐标值平移，让rect和鼠标坐标系一致</span><br><span class="line">        if(rect.contains(event-&gt;pos()) &#x3D;&#x3D; true)&#123;        &#x2F;&#x2F;判断鼠标点击位置是否在rect范围中</span><br><span class="line">            m_drag &#x3D; true;</span><br><span class="line">            m_pos &#x3D; ui-&gt;label-&gt;pos() - event-&gt;pos();    &#x2F;&#x2F;记录label和鼠标的相对位置</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;鼠标抬起时执行的事件处理函数</span><br><span class="line">void MouseDialog::mouseReleaseEvent(QMouseEvent *event)&#123;</span><br><span class="line"></span><br><span class="line">    if(event-&gt;button() &#x3D;&#x3D; Qt::LeftButton)&#123;</span><br><span class="line">        m_drag &#x3D; false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;鼠标移动时执行的事件处理函数</span><br><span class="line">void MouseDialog::mouseMoveEvent(QMouseEvent *event)&#123;</span><br><span class="line"></span><br><span class="line">    if(m_drag &#x3D;&#x3D; true)&#123;</span><br><span class="line">        QPoint newPos &#x3D; m_pos + event-&gt;pos();   &#x2F;&#x2F;计算label移动的新位置</span><br><span class="line">        QSize s1 &#x3D; size();                      &#x2F;&#x2F;获取窗口大小</span><br><span class="line">        QSize s2 &#x3D; ui-&gt;label-&gt;size();           &#x2F;&#x2F;获取label大小</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;设置label移动范围：不能超出父窗口</span><br><span class="line">        if(newPos.x()&lt;0)&#123;                       &#x2F;&#x2F;x:最小值（0）最大值（窗口宽-label宽）</span><br><span class="line">            newPos.setX(0);</span><br><span class="line">        &#125;</span><br><span class="line">        else if (newPos.x() &gt; s1.width()-s2.width()) &#123;</span><br><span class="line">            newPos.setX(s1.width()-s2.width());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(newPos.y()&lt;0)&#123;                       &#x2F;&#x2F;y:最小值（0）最大值（窗口高-label高）</span><br><span class="line">            newPos.setY(0);</span><br><span class="line">        &#125;</span><br><span class="line">        else if (newPos.y()&gt;s1.height()-s2.height()) &#123;</span><br><span class="line">            newPos.setY(s1.height()-s2.height());</span><br><span class="line">        &#125;</span><br><span class="line">        ui-&gt;label-&gt;move(newPos);                &#x2F;&#x2F;移动label到新位置</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/Gp0mjt5qZq20tp8sYe/giphy.gif" alt="鼠标拖动方块"></p>
<ol start="2">
<li>键盘事件<br>#include &lt;QKeyEvent&gt;<br>virtual void keyPressEvent (QKeyEvent *);//按键按下时执行的事件处理函数<br>virtual void keyReleaseEvent(QKeyEvent *);//按键抬起时执行的事件处理函数</li>
</ol>
<p><strong>案例：键盘按键测试，实现通过键盘方向键控制label移动</strong></p>
<ul>
<li>工程名：Keyboard</li>
<li>类名：KeyboardDialog</li>
</ul>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#ifndef KEYBOARDDIALOG_H</span><br><span class="line">#define KEYBOARDDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QKeyEvent&gt;</span><br><span class="line"></span><br><span class="line">namespace Ui &#123;</span><br><span class="line">class KeyboardDialog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class KeyboardDialog : public QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    explicit KeyboardDialog(QWidget *parent &#x3D; nullptr);</span><br><span class="line">    ~KeyboardDialog();</span><br><span class="line">private:</span><br><span class="line">    void keyPressEvent(QKeyEvent *event);&#x2F;&#x2F;键盘按键按下时执行的事件处理函数</span><br><span class="line">private:</span><br><span class="line">    Ui::KeyboardDialog *ui;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; KEYBOARDDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;keyboarddialog.h&quot;</span><br><span class="line">#include &quot;ui_keyboarddialog.h&quot;</span><br><span class="line"></span><br><span class="line">KeyboardDialog::KeyboardDialog(QWidget *parent) :</span><br><span class="line">    QDialog(parent),</span><br><span class="line">    ui(new Ui::KeyboardDialog)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;setupUi(this);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">KeyboardDialog::~KeyboardDialog()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br><span class="line">void KeyboardDialog::keyPressEvent(QKeyEvent *event)&#123;</span><br><span class="line">    &#x2F;&#x2F;获取label的当前位置</span><br><span class="line">    int x &#x3D; ui-&gt;label-&gt;pos().x();</span><br><span class="line">    int y &#x3D; ui-&gt;label-&gt;pos().y();</span><br><span class="line">    if(event-&gt;key() &#x3D;&#x3D; Qt::Key_Left)&#123;</span><br><span class="line">        ui-&gt;label-&gt;move(x-10,y);</span><br><span class="line">    &#125;</span><br><span class="line">    else if (event-&gt;key() &#x3D;&#x3D; Qt::Key_Right) &#123;</span><br><span class="line">        ui-&gt;label-&gt;move(x+10,y);</span><br><span class="line">    &#125;</span><br><span class="line">    else if (event-&gt;key() &#x3D;&#x3D; Qt::Key_Up) &#123;</span><br><span class="line">        ui-&gt;label-&gt;move(x,y-10);</span><br><span class="line">    &#125;</span><br><span class="line">    else if (event-&gt;key() &#x3D;&#x3D; Qt::Key_Down) &#123;</span><br><span class="line">        ui-&gt;label-&gt;move(x,y+10);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/BqusPAxqfHtkBLYe0S/giphy.gif" alt="键盘操控方块"></p>
<hr>
<h2 id="九、Qt多线程（QThread）"><a href="#九、Qt多线程（QThread）" class="headerlink" title="九、Qt多线程（QThread）"></a>九、Qt多线程（QThread）</h2><ol>
<li><p>创建线程方法1：QObject::moveToThread<br> class Myclass:public QObject{<br> Q_OBJECT<br>public slots:<br> void func(void){</p>
<pre><code> //耗时或阻塞操作，需要放在子线程中执行</code></pre>
<p> }<br>}；<br>QThread thread;//子线程对象<br>Myclass myobject;//需要放在子线程中工作的对象<br>myobject.moveToThread(&amp;thread);//将myobject对象移动到子线程中<br>connect(xx,SIGNAL(XX),&amp;myobject,SLOT(func()));//连接信号和槽函数<br>thread.start();//开启子线程(exec),麻烦，但是更灵活</p>
</li>
<li><p>创建线程方法2：继承QThread，重写线程入口函数run</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class MyClass::public QThread&#123;</span><br><span class="line">protected:</span><br><span class="line">	virtual void run(void)&#123;</span><br><span class="line">		&#x2F;&#x2F;耗时或阻塞操作，需要放在子线程中执行</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line">MyClass mythread;&#x2F;&#x2F;创建子线程对象</span><br><span class="line">mythread.start();&#x2F;&#x2F;开启子线程，子类中重写run函数将会在子线程中执行(不够灵活,但是简单)</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>案例：多线程打印消息</strong></p>
<ul>
<li>方法1：工程（Thread1）</li>
<li>方法2：工程（Thread2）</li>
</ul>
<ol start="3">
<li>线程同步</li>
</ol>
<ul>
<li>互斥锁：QMutex（加锁lock（）会让其他线程在同样的事件中，进入阻塞…）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">eg:</span><br><span class="line">	QMutex mutex;</span><br><span class="line">	void run(void)&#123;</span><br><span class="line">		mutex.lock();&#x2F;&#x2F;加锁</span><br><span class="line">		&#x2F;&#x2F;访问共享资源start</span><br><span class="line">		if(&quot;Error1&quot;)&#123;</span><br><span class="line">			mutex.unlock();&#x2F;&#x2F;解锁</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line">		else if(&quot;Error2&quot;)&#123;</span><br><span class="line">			mutex.unlock();&#x2F;&#x2F;解锁</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line">		&#x2F;&#x2F;访问共享资源end</span><br><span class="line">		mutex.unlock();&#x2F;&#x2F;解锁</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="4">
<li>QMutexLocker简化加锁和解锁过程；</li>
</ol>
<ul>
<li>互斥锁：QMutex（加锁lock（）会让其他线程在同样的事件中，进入阻塞…）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">eg:</span><br><span class="line">	QMutex mutex;</span><br><span class="line">	void run(void)&#123;</span><br><span class="line">		QMutexLocker locker(&amp;mutex);&#x2F;&#x2F;加锁(不需要写解锁)</span><br><span class="line">		&#x2F;&#x2F;访问共享资源start</span><br><span class="line">		if(&quot;Error1&quot;)&#123;</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line">		else if(&quot;Error2&quot;)&#123;</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line">		&#x2F;&#x2F;访问共享资源end</span><br><span class="line">	&#125;&#x2F;&#x2F;析构locker时，在析构函数中自动解锁</span><br></pre></td></tr></table></figure></li>
<li>信号量：QSemaphore<br>//初始化信号量计数值5，表示有5个可用共享资源<br>QSemaphore sem(5);      // sem.available() == 5<br>//获取3个共享资源，剩余2个可用的共享资源<br>sem.acquire(3);         // sem.available() == 2<br>sem.acquire(2);         // sem.available() == 0<br>//释放5个共享资源，剩余5个可用的共享资源<br>sem.release(5);         // sem.available() == 5<br>sem.release(5);         // sem.available() == 10<br>//尝试获取1个共享资源，剩余9个可用的共享资源，获取成功<br>sem.tryAcquire(1);      // sem.available() == 9, returns true<br>//尝试获取250个共享资源，获取失败，会返回错误<br>sem.tryAcquire(250);    // sem.available() == 9, returns false</li>
</ul>
<p><strong>案例：生产者和消费者</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;QtCore&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">  const int DataSize &#x3D; 100000;&#x2F;&#x2F;要生产的产品数量</span><br><span class="line"></span><br><span class="line">  const int BufferSize &#x3D; 8192;&#x2F;&#x2F;缓冲区大小8K</span><br><span class="line">  char buffer[BufferSize];</span><br><span class="line"></span><br><span class="line">  QSemaphore freeBytes(BufferSize);&#x2F;&#x2F;控制生产者的信号量，初始化为8K</span><br><span class="line">  QSemaphore usedBytes;&#x2F;&#x2F;控制消费者的信号量，初始化为0</span><br><span class="line"></span><br><span class="line">  class Producer : public QThread&#x2F;&#x2F;生产者线程</span><br><span class="line">  &#123;</span><br><span class="line">  public:</span><br><span class="line">      void run() override</span><br><span class="line">      &#123;</span><br><span class="line">          for (int i &#x3D; 0; i &lt; DataSize; ++i) &#123;</span><br><span class="line">              freeBytes.acquire();&#x2F;&#x2F;获取生产者的信号量，计数-1</span><br><span class="line">              buffer[i % BufferSize] &#x3D; &quot;ACGT&quot;[QRandomGenerator::global()-&gt;bounded(4)];</span><br><span class="line">              usedBytes.release();&#x2F;&#x2F;释放消费者信号量，计数+1</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  class Consumer : public QThread&#x2F;&#x2F;消费者线程</span><br><span class="line">  &#123;</span><br><span class="line">      Q_OBJECT</span><br><span class="line">  public:</span><br><span class="line">      void run() override</span><br><span class="line">      &#123;</span><br><span class="line">          for (int i &#x3D; 0; i &lt; DataSize; ++i) &#123;</span><br><span class="line">              usedBytes.acquire();&#x2F;&#x2F;获取消费者信号量，计数-1</span><br><span class="line">              fprintf(stderr, &quot;%c&quot;, buffer[i % BufferSize]);</span><br><span class="line">              freeBytes.release();&#x2F;&#x2F;释放生产者的信号量。计数+1</span><br><span class="line">          &#125;</span><br><span class="line">          fprintf(stderr, &quot;\n&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  int main(int argc, char *argv[])</span><br><span class="line">  &#123;</span><br><span class="line">      QCoreApplication app(argc, argv);&#x2F;&#x2F;创建没有GUI应用的程序</span><br><span class="line">      Producer producer;&#x2F;&#x2F;生产者</span><br><span class="line">      Consumer consumer;&#x2F;&#x2F;消费者</span><br><span class="line">      producer.start();</span><br><span class="line">      consumer.start();</span><br><span class="line">      producer.wait();</span><br><span class="line">      consumer.wait();</span><br><span class="line">      return 0;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="十、Qt数据库"><a href="#十、Qt数据库" class="headerlink" title="十、Qt数据库"></a>十、Qt数据库</h2><ol>
<li>数据库简介</li>
</ol>
<ul>
<li>概念<br>数据库是以一定的方式存储在一起、能为用户共享、具有尽可能小的冗余特性，是与应用程序彼此独立的数据集合。</li>
<li>相关术语<br>DB：数据库（database）<br>DBA：数据库管理员<br>RDB：关系式数据库<br>DBMS：数据库管理系统</li>
<li>常见的数据库<br>//大型的商业数据库<br>甲骨文的Oracle<br>IBM的DB2<br>微软的Sqlserver<br>//免费的数据库<br>Sun的Mysql<br>开源的Sqlite</li>
<li>数据库操作语言（SQL）</li>
</ul>
<ol start="2">
<li>Sqlite数据库</li>
</ol>
<ul>
<li><p>Windows安装Sqlite<br>请访问 SQLite 下载页面<a target="_blank" rel="noopener" href="https://www.sqlite.org/download.html%EF%BC%8C%E4%BB%8E">https://www.sqlite.org/download.html，从</a> Windows 区下载预编译的二进制文件。<br>需要下载 sqlite-tools-win32-<em>.zip 和 sqlite-dll-win32-</em>.zip 压缩文件。<br>创建文件夹 C:\sqlite，并在此文件夹下解压上面两个压缩文件，将得到 sqlite3.def、sqlite3.dll 和 sqlite3.exe 文件。<br>添加 C:\sqlite 到 PATH 环境变量，最后在命令提示符下，使用 sqlite3 命令，将显示如下结果。</p>
</li>
<li><p>Linux安装SQLite<br>目前，几乎所有版本的 Linux 操作系统都附带 SQLite。所以，只要使用下面的命令来检查您的机器上是否已经安装了 SQLite。<br>$ sqlite3</p>
</li>
<li><p>测试<br>在“sqlite&gt;”命令界面中可以输入两种指令，一种指令是以“.”开头，可以实现对数据库配置和设置数据显示方式；<br>另一种指令是“Sql语句”，这些指令以“;”结尾，实现对数据的增删改查等管理操作。</p>
</li>
<li><p>常用的sqlite自身配置和格式显示相关命令<br>.help//打开帮助<br>.exit//退出数据库<br>.database//查看当前数据库名称<br>.open testDB.db//打开数据库文件.db<br>.table//查看数据库中数据表的名字<br>.mode MODE//设置数据表显示模式，MODE:list（默认）/column/tab/html…<br>.header on//显示数据的表头<br>.schema//查看数据表创建时的详细信息<br>.nullvalue “NULL”//设置数据表空白位置显示数值“NULL”</p>
</li>
</ul>
<p>注：清屏“Ctrl+L”<br>注：执行“SELECT * FROM company;”可以查看company数据中所有的数据。<br>注：可以将上述指令写入配置文件中，将来重新进入数据库界面时会自动执行。</p>
<ol start="3">
<li>使用SQL语言操作数据库//重点</li>
</ol>
<ul>
<li>创建数据表<br>语法：<br>CREATE TABLE 表名 (列名1 数据类型 [约束], 列名2 数据类型 [约束],…);<br>常用数据类型：<br>INT（整型数）TEXT（字符串）REAL（浮点数）<br>常用约束：<br>NOT NULL：非空约束，表示该类数据不能为空<br>PRIMARY KEY：主键约束，表示该列数据唯一，可以加快对数据的访问</li>
<li>删除数据表<br>语法：<br>DROP TABLE 表名;<br>注：慎用，数据表一旦删除，里面所包含的数据也将随之消失！</li>
<li>向数据表插入数据<br>语法：<br>INSERT INTO 表名(列名1,列名2,…) VALUES(数值1,数值2,…);</li>
<li>从数据表中删除数据<br>语法：<br>DELETE FROM 表名WHERE 条件表达式;//删除满足条件的若干条数据<br>DELETE FROM 表名WHERE 条件1 and 条件2;//删除同时满足两个条件的数据<br>DELETE FROM 表名WHERE 条件1 or 条件2;//删除满足条件1或条件2的数据</li>
<li>修改数据表中已存在的数据<br>语法：<br>UPDATE 表名 SET 列名1=新数值,列名2=新数值,… WHERE 条件表达式;//条件表达式中一般是要修改数据的id号</li>
<li>查询数据表中的数据<br>语法：<br>SELET 列名1,列名2,… FROM 表名;<br>SELET 列名1,列名2,… FROM 表名 WHERE 条件表达式;<br>SELET 列名1,列名2,… FROM 表名 WHERE 条件表达式 ORDER BY 列名 排列方式;<br>注：排序方式关键字ASC（升序）/DESC（降序）</li>
</ul>
<ol start="4">
<li>在Qt应用程序中使用Sqlite数据库（QT += sql）</li>
</ol>
<ul>
<li><p>建立Qt应用程序和数据库连接 QSqlDatabase<br>//添加数据库驱动<br>QSqlDatabase db = QSqlDatabase: :addDatabase (“OSQLITE”‘);<br>//设置数据库名字(对于sqlite就是数据库文件名)<br>db.setDatabaseName ( “testDB.db” ) ;<br>//打开数据库<br>bool ok = db.open () ;</p>
</li>
<li><p>执行SQL语句 QSqlQuery<br>//创建QsqlQuery对象<br>QsqlQuery query;<br>//准备要执行的sQL语句字符串<br>QString str = Qstring ( “SQL语句”);//执行sql语句<br>query.exec (str) ;</p>
</li>
<li><p>保存查询结果集 QSqlQueryModel<br>//创建QSqlQueryModel对象<br>QSqlQueryModel *model = new QSqlQueryModel;1l执行SELECT语句并保存结果集到model<br>model-&gt;setQuery ( “SELECT语句”);<br>/将model保存结果显示图形控件(QTableView)上QTableview *view = new QTableview ;<br>view-&gt;setModel (model) ;<br>view-&gt;show () ;</p>
</li>
</ul>
<p><strong>案例：学生成绩管理系统</strong></p>
<ul>
<li>工程名：Student</li>
<li>类名：StudentDailog</li>
<li>.pro文件中QT += sql</li>
<li>界面设计<br>拖拽需要使用的控件<br>ComboBox（2个，组合框）<br>PushButton（4个）<br>Label（3个）<br>LineEdit(3个)<br>TableView(1个，表格：用于显示查询结果集)<br>设置对象名<br>ComboBox:valueComboBox  condComboBox<br>PushButton:sortButton  insertButton  updateButton  deleteButton<br>LineEdit:idEdit  nameEdit  scoreEdit<br>Label:默认<br>TableView:默认</li>
</ul>
<hr>
<h2 id="十一、Qt网络编程"><a href="#十一、Qt网络编程" class="headerlink" title="十一、Qt网络编程"></a>十一、Qt网络编程</h2><ol>
<li>网络编程基础</li>
</ol>
<ul>
<li>网络协议模型（OSI七层）<br>应用层：HTTP<br>表示层<br>会话层<br>传输层：TCP、UDP(TCP安全、UDP效率高)<br>网络层：IP（IPV4/IPV6）<br>数据链路层<br>物理层</li>
</ul>
<ol start="2">
<li>IP地址</li>
</ol>
<ul>
<li>概念：<br>互联网中的唯一地址标识</li>
<li>IP地址表示方式：<br>IPV4（32位整数）、IPV6（128位整数）<br>点分十进制：“192.168.15.100”<br>无符号整数：0xC0A80F64</li>
<li>查看IP地址命令<br>windows系统:ipconfig<br>linux系统:ifconfig</li>
<li>通过IP地址判断两台主机能否通信<br>ping 对方的IP地址;</li>
<li>特殊的IP地址<br>“0.0.0.0”//任意地址，INADDR_ANY，常用于服务器<br>“127.0.0.1”//本地环回地址，常用于测试<br>“255.255.255.255”//广播地址</li>
</ul>
<ol start="3">
<li>Qt中和网络编程相关类（Qt+= network）</li>
</ol>
<ul>
<li>套接字基类：QAbstractsocket</li>
<li>TCP通信套接字：Tcpsocket</li>
<li>TCP服务器：TcpServer</li>
<li>UDP通信套接字：QUdpsocket</li>
<li>IP地址：QHostAddress</li>
</ul>
<ol start="4">
<li>常见问题</li>
</ol>
<ul>
<li>windows空闲端口号查询方式</li>
</ul>
<p>如下图所示，在cmd中使用指令查询所有端口号<br><img src="https://gitee.com/lu-qixin/murmur-ofthe-heart7.gitee.io/rew/master/images/blog/qt%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E7%AB%AF%E5%8F%A3%E5%8F%B7%E6%9F%A5%E8%AF%A21.png" alt="查询所有端口号" title="端口号查询"></p>
<p>如下图所示，在cmd中使用失灵查询所需端口号是否为空闲状态<br><img src="https://gitee.com/lu-qixin/murmur-ofthe-heart7.gitee.io/rew/master/images/blog/qt%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E7%AB%AF%E5%8F%A3%E5%8F%B7%E6%9F%A5%E8%AF%A22.png" alt="查询端口号是否空闲"></p>
<p><strong>案例：基于TCP协议的网络聊天室</strong></p>
<ul>
<li>TCP服务器（Server）（服务器：IP、port固定）<br>使用QTcpServer创建服务器<br>响应客户端连接请求，保存和客户端通信套接字（socket）<br>实时接收客户端发来的消息<br>转发消息给所有的客户端</li>
</ul>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#ifndef SERVERDIALOG_H</span><br><span class="line">#define SERVERDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QTcpServer&gt;</span><br><span class="line">#include &lt;QTcpSocket&gt;</span><br><span class="line">#include &lt;QDebug&gt;</span><br><span class="line">#include &lt;QTimer&gt;</span><br><span class="line"></span><br><span class="line">namespace Ui &#123;</span><br><span class="line">class ServerDialog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ServerDialog : public QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    explicit ServerDialog(QWidget *parent &#x3D; nullptr);</span><br><span class="line">    ~ServerDialog();</span><br><span class="line"></span><br><span class="line">private slots:</span><br><span class="line">    void on_pushButton_clicked();           &#x2F;&#x2F;创建服务器按钮对应的槽函数</span><br><span class="line">    void onNewConnection();                 &#x2F;&#x2F;响应客户端连接请求的槽函数</span><br><span class="line">    void onReadyRead();                     &#x2F;&#x2F;接收客户端聊天消息的槽函数</span><br><span class="line">    void sendMessage(const QByteArray&amp;);    &#x2F;&#x2F;转发聊天消息给其他客户端的槽函数</span><br><span class="line">    void onTimeout(void);                   &#x2F;&#x2F;定时器检查客户端套接字是否为正常连接状态的槽函数</span><br><span class="line">private:</span><br><span class="line">    Ui::ServerDialog *ui;</span><br><span class="line">    QTcpServer tcpServer;               &#x2F;&#x2F;TCP服务器</span><br><span class="line">    quint16 port;                       &#x2F;&#x2F;服务器端口，quint16--&gt;unsigned short</span><br><span class="line">    QList&lt;QTcpSocket*&gt;tcpClientList;    &#x2F;&#x2F;容器：保存和客户端通信的套接字</span><br><span class="line">    QTimer timer;                       &#x2F;&#x2F;定时器，定时检查容器中和客户端通信的套接字是否为正常连接状态</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; SERVERDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;serverdialog.h&quot;</span><br><span class="line">#include &quot;ui_serverdialog.h&quot;</span><br><span class="line"></span><br><span class="line">ServerDialog::ServerDialog(QWidget *parent) :</span><br><span class="line">    QDialog(parent),</span><br><span class="line">    ui(new Ui::ServerDialog)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;setupUi(this);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ServerDialog::~ServerDialog()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;创建服务器按钮对应的槽函数</span><br><span class="line">void ServerDialog::on_pushButton_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    port &#x3D; ui-&gt;lineEdit-&gt;text().toUShort();  &#x2F;&#x2F;获取服务器端口</span><br><span class="line">    &#x2F;&#x2F;设置监听服务器的IP和端口;QHostAddress::Any&#x3D;&#x3D;&gt;QHostAddress(&quot;0.0.0.0&quot;)</span><br><span class="line">    if(tcpServer.listen(QHostAddress::Any,port)&#x3D;&#x3D;false)&#123;</span><br><span class="line">        qDebug() &lt;&lt; &quot;创建服务器失败&quot;;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        qDebug() &lt;&lt; &quot;创建服务器成功&quot;;</span><br><span class="line">        &#x2F;&#x2F;当有客户端向服务器发送连接请求时，发送信号newConnection</span><br><span class="line">        connect(&amp;tcpServer,SIGNAL(newConnection()),this,SLOT(onNewConnection()));</span><br><span class="line">        ui-&gt;lineEdit-&gt;setEnabled(false);    &#x2F;&#x2F;禁用端口输入和创建服务器的按钮</span><br><span class="line">        ui-&gt;pushButton-&gt;setEnabled(false);</span><br><span class="line"></span><br><span class="line">        connect(&amp;timer,SIGNAL(timeout()),this,SLOT(onTimeout()));   &#x2F;&#x2F;定时器到时发送信号:timeout</span><br><span class="line">        timer.start(3000);                                          &#x2F;&#x2F;开启定时器，每隔3秒检查一次</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;响应客户端连接请求的槽函数</span><br><span class="line">void ServerDialog::onNewConnection()&#123;</span><br><span class="line">    QTcpSocket* tcpClient &#x3D; tcpServer.nextPendingConnection();  &#x2F;&#x2F;获取和客户端通信的套接字</span><br><span class="line">    tcpClientList.append(tcpClient);                            &#x2F;&#x2F;保存套接字到容器中</span><br><span class="line">    &#x2F;&#x2F;当客户端给服务器发送消息时，tcpClient发送信号readyRead</span><br><span class="line">    connect(tcpClient,SIGNAL(readyRead()),this,SLOT(onReadyRead()));</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;接收客户端聊天消息的槽函数</span><br><span class="line">void ServerDialog::onReadyRead()&#123;</span><br><span class="line">    &#x2F;&#x2F;遍历检查哪个客户端有消息</span><br><span class="line">    for (int i&#x3D;0;i&lt;tcpClientList.size();i++) &#123;</span><br><span class="line">        &#x2F;&#x2F;at(i):获取容器中第i套接字(QTcpSocket*)</span><br><span class="line">        &#x2F;&#x2F;bytesAvailable:获取当前套接字等待读取消息的字节数，如果为0表示没有消息，如果大于0表示有消息</span><br><span class="line">        if(tcpClientList.at(i)-&gt;bytesAvailable())&#123;</span><br><span class="line">            QByteArray buf &#x3D; tcpClientList.at(i)-&gt;readAll();    &#x2F;&#x2F;读取消息并保存</span><br><span class="line">            ui-&gt;listWidget-&gt;addItem(buf);                       &#x2F;&#x2F;显示消息</span><br><span class="line">            ui-&gt;listWidget-&gt;scrollToBottom();                   &#x2F;&#x2F;回滚到最底部(最新消息)</span><br><span class="line">            sendMessage(buf);                                   &#x2F;&#x2F;转发消息给其他客户端</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;转发聊天消息给其他客户端的槽函数</span><br><span class="line">void ServerDialog::sendMessage(const QByteArray&amp; msg)&#123;</span><br><span class="line">    for (int i&#x3D;0;i&lt;tcpClientList.size();i++) &#123;</span><br><span class="line">        tcpClientList.at(i)-&gt;write(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void ServerDialog::onTimeout(void)&#123;</span><br><span class="line">    for (int i&#x3D;0;i&lt;tcpClientList.size();i++) &#123;</span><br><span class="line">        &#x2F;&#x2F;state():获取第i个套接字的连接状态</span><br><span class="line">        &#x2F;&#x2F;UnconnectedState:表示未连接(断开连接)</span><br><span class="line">        if(tcpClientList.at(i)-&gt;state() &#x3D;&#x3D; QAbstractSocket::UnconnectedState)&#123;</span><br><span class="line">            tcpClientList.removeAt(i);&#x2F;&#x2F;从容器中将断开连接的套接字移除</span><br><span class="line">            --i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>TCP客户端（Client）<br>使用QTcpSocket创建和服务器通信的套接字<br>向服务器发送连接请求<br>输入聊天消息，发送到服务器<br>接收服务器转发的消息并显示</li>
</ul>
<p><strong>代码实现</strong><br>头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#ifndef CLIENTDIALOG_H</span><br><span class="line">#define CLIENTDIALOG_H</span><br><span class="line"></span><br><span class="line">#include &lt;QDialog&gt;</span><br><span class="line">#include &lt;QTcpSocket&gt;</span><br><span class="line">#include &lt;QHostAddress&gt;</span><br><span class="line">#include &lt;QMessageBox&gt;</span><br><span class="line"></span><br><span class="line">namespace Ui &#123;</span><br><span class="line">class ClientDialog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ClientDialog : public QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    explicit ClientDialog(QWidget *parent &#x3D; nullptr);</span><br><span class="line">    ~ClientDialog();</span><br><span class="line"></span><br><span class="line">private slots:</span><br><span class="line">    void on_sendButton_clicked();       &#x2F;&#x2F;发送按钮对应的槽函数</span><br><span class="line">    void on_connectButton_clicked();    &#x2F;&#x2F;连接按钮对应的槽函数</span><br><span class="line">    void onConnected(void);             &#x2F;&#x2F;和服务器连接成功时执行的槽函数</span><br><span class="line">    void onDisconnected(void);          &#x2F;&#x2F;和服务器断开连接时执行的槽函数</span><br><span class="line">    void onReadyRead(void);             &#x2F;&#x2F;接收服务器转发聊天消息的槽函数</span><br><span class="line">    void onError(void);                 &#x2F;&#x2F;网络通信异常时执行的槽函数</span><br><span class="line">private:</span><br><span class="line">    Ui::ClientDialog *ui;</span><br><span class="line">    bool status;            &#x2F;&#x2F;客户端状态标记，true在线，false离线</span><br><span class="line">    QTcpSocket tcpSocket;   &#x2F;&#x2F;和服务器通信的tcp套接字</span><br><span class="line">    QHostAddress serverIp;  &#x2F;&#x2F;服务器地址</span><br><span class="line">    quint16 serverPort;     &#x2F;&#x2F;服务器端口</span><br><span class="line">    QString username;       &#x2F;&#x2F;聊天室昵称</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif &#x2F;&#x2F; CLIENTDIALOG_H</span><br></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;clientdialog.h&quot;</span><br><span class="line">#include &quot;ui_clientdialog.h&quot;</span><br><span class="line"></span><br><span class="line">ClientDialog::ClientDialog(QWidget *parent) :</span><br><span class="line">    QDialog(parent),</span><br><span class="line">    ui(new Ui::ClientDialog)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;setupUi(this);</span><br><span class="line">    status &#x3D; false;</span><br><span class="line">    connect(&amp;tcpSocket,SIGNAL(connected()),this,SLOT(onConnected()));                       &#x2F;&#x2F;和服务器连接成功时，发送connected</span><br><span class="line">    connect(&amp;tcpSocket,SIGNAL(disconnected()),this,SLOT(onDisconnected()));                   &#x2F;&#x2F;和服务器断开连接时，发送disconnected</span><br><span class="line">    connect(&amp;tcpSocket,SIGNAL(readyRead()),this,SLOT(onReadyRead()));                       &#x2F;&#x2F;收到聊天消息时，发送readyRead</span><br><span class="line">    connect(&amp;tcpSocket,SIGNAL(error(QAbstractSocket::SocketError)),this,SLOT(onError()));   &#x2F;&#x2F;网络通信异常时，发送error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ClientDialog::~ClientDialog()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;发送按钮对应的槽函数</span><br><span class="line">void ClientDialog::on_sendButton_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    QString msg &#x3D; ui-&gt;messageEdit-&gt;text();  &#x2F;&#x2F;获取用户输入的消息</span><br><span class="line">    if(msg &#x3D;&#x3D; &quot;&quot;)&#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    msg &#x3D; username + &quot;:&quot; + msg;</span><br><span class="line">    tcpSocket.write(msg.toUtf8());          &#x2F;&#x2F;发送消息</span><br><span class="line">    ui-&gt;messageEdit-&gt;clear();               &#x2F;&#x2F;清空已输入的消息</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;连接按钮对应的槽函数</span><br><span class="line">void ClientDialog::on_connectButton_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    if(status &#x3D;&#x3D; false)&#123;&#x2F;&#x2F;如果当前是离线状态，则连接服务器</span><br><span class="line">        if(serverIp.setAddress(ui-&gt;serveripEdit-&gt;text()) &#x3D;&#x3D; false)&#123; &#x2F;&#x2F;获取服务器IP</span><br><span class="line">                QMessageBox::critical(this,&quot;Error&quot;,&quot;IP地址错误&quot;);    &#x2F;&#x2F;critical()表示错误的消息提示框</span><br><span class="line">                return;</span><br><span class="line">        &#125;</span><br><span class="line">        serverPort &#x3D; ui-&gt;serverportEdit-&gt;text().toUShort(); &#x2F;&#x2F;获取服务器端口</span><br><span class="line">        if(serverPort &lt; 1024)&#123;</span><br><span class="line">            QMessageBox::critical(this,&quot;Error&quot;,&quot;端口格式错误&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        username &#x3D; ui-&gt;usernameEdit-&gt;text();                &#x2F;&#x2F;获取聊天室昵称</span><br><span class="line">        if(username &#x3D;&#x3D; &quot;&quot;)&#123;</span><br><span class="line">            QMessageBox::critical(this,&quot;Error&quot;,&quot;聊天室昵称不能为空&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;向服务器发送连接请求</span><br><span class="line">        &#x2F;&#x2F;如果成功，发送信号connected</span><br><span class="line">        &#x2F;&#x2F;如果失败，发送信号error</span><br><span class="line">        tcpSocket.connectToHost(serverIp,serverPort);</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;                                      &#x2F;&#x2F;如果当前是在线状态，则断开和服务器连接</span><br><span class="line">        QString msg &#x3D; username + &quot;:离开了聊天室&quot;; &#x2F;&#x2F;向服务器发送离开聊天室的消息</span><br><span class="line">        tcpSocket.write(msg.toUtf8());          &#x2F;&#x2F;toUtf8():将QString(unicode)转换QByteArray(utf-8)</span><br><span class="line">        tcpSocket.disconnectFromHost();         &#x2F;&#x2F;断开连接,断开后发送信号:disconnected</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;和服务器连接成功时执行的槽函数</span><br><span class="line">void ClientDialog::onConnected(void)&#123;</span><br><span class="line">    status &#x3D; true;                              &#x2F;&#x2F;设置状态标记:在线</span><br><span class="line">    ui-&gt;sendButton-&gt;setEnabled(true);           &#x2F;&#x2F;恢复&quot;发送&quot;按钮为正常可用状态</span><br><span class="line">    ui-&gt;serveripEdit-&gt;setEnabled(false);        &#x2F;&#x2F;禁用ip输入</span><br><span class="line">    ui-&gt;serverportEdit-&gt;setEnabled(false);      &#x2F;&#x2F;禁用端口输入</span><br><span class="line">    ui-&gt;usernameEdit-&gt;setEnabled(false);        &#x2F;&#x2F;禁用昵称输入</span><br><span class="line">    ui-&gt;connectButton-&gt;setText(&quot;离开聊天室&quot;);     &#x2F;&#x2F;修改连接服务器按钮文本</span><br><span class="line">    QString msg &#x3D; username + &quot;:进入了聊天室&quot;;     &#x2F;&#x2F;向服务器发送进入聊天室的提示消息</span><br><span class="line">    tcpSocket.write(msg.toUtf8());              &#x2F;&#x2F;toUtf8():将QString(unicode)转换QByteArray(utf-8)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;和服务器断开连接时执行的槽函数</span><br><span class="line">void ClientDialog::onDisconnected(void)&#123;</span><br><span class="line">    status &#x3D; false;                             &#x2F;&#x2F;设置离线状态</span><br><span class="line">    ui-&gt;sendButton-&gt;setEnabled(false);          &#x2F;&#x2F;禁用&quot;发送&quot;按钮</span><br><span class="line">    ui-&gt;serveripEdit-&gt;setEnabled(true);         &#x2F;&#x2F;恢复ip输入</span><br><span class="line">    ui-&gt;serverportEdit-&gt;setEnabled(true);       &#x2F;&#x2F;恢复端口输入</span><br><span class="line">    ui-&gt;usernameEdit-&gt;setEnabled(true);         &#x2F;&#x2F;恢复昵称输入</span><br><span class="line">    ui-&gt;connectButton-&gt;setText(&quot;连接服务器&quot;);    &#x2F;&#x2F;修改离开聊天室按钮文本</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;接收服务器转发聊天消息的槽函数</span><br><span class="line">void ClientDialog::onReadyRead(void)&#123;</span><br><span class="line">    if(tcpSocket.bytesAvailable())&#123;             &#x2F;&#x2F;bytesAvailable()获取等待读取消息的字节数</span><br><span class="line">        QByteArray buf &#x3D; tcpSocket.readAll();   &#x2F;&#x2F;读取消息</span><br><span class="line">        ui-&gt;listWidget-&gt;addItem(buf);           &#x2F;&#x2F;显示消息到界面</span><br><span class="line">        ui-&gt;listWidget-&gt;scrollToBottom();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;网络通信异常时执行的槽函数</span><br><span class="line">void ClientDialog::onError(void)&#123;</span><br><span class="line">    QMessageBox::critical(this,&quot;Error&quot;,tcpSocket.errorString());    &#x2F;&#x2F;errorString()获取网络通信异常原因的字符串</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br><img src="https://media.giphy.com/media/YvodmdUJllnMqXAT1Z/giphy.gif" alt="聊天界面展示"></p>
<hr>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/1/16/%E5%88%A9%E7%94%A8Wordpress%E7%AE%A1%E7%90%86%E4%B8%8E%E7%BB%B4%E6%8A%A4%E7%BD%91%E7%AB%99/" rel="prev" title="利用Wordpress管理与维护网站">
      <i class="fa fa-chevron-left"></i> 利用Wordpress管理与维护网站
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Qt%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="nav-number">1.</span> <span class="nav-text">Qt学习笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81qt%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">一、qt概述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-qt%E5%8F%91%E5%B1%95%E5%8E%86%E5%8F%B2"><span class="nav-number">1.1.0.1.</span> <span class="nav-text">1. qt发展历史</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.0.2.</span> <span class="nav-text">2. 相关工具介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%8A%A9%E6%89%8B%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="nav-number">1.1.0.3.</span> <span class="nav-text">3. 助手中常用的模块</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AAqt%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.2.</span> <span class="nav-text">第一个qt程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#qt%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88QString%EF%BC%89%E5%92%8C%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81"><span class="nav-number">1.2.0.1.</span> <span class="nav-text">qt字符串（QString）和字符编码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD%E6%9C%BA%E5%88%B6"><span class="nav-number">1.3.</span> <span class="nav-text">二、信号和槽机制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%A6%82%E5%BF%B5"><span class="nav-number">1.3.0.1.</span> <span class="nav-text">1. 概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%AE%9A%E4%B9%89"><span class="nav-number">1.3.0.2.</span> <span class="nav-text">2. 定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.3.0.3.</span> <span class="nav-text">3. 信号和槽连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E4%BF%A1%E5%8F%B7%E4%B8%8E%E6%A7%BD%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%AF%AD%E6%B3%95%E8%A6%81%E6%B1%82"><span class="nav-number">1.3.0.4.</span> <span class="nav-text">4. 信号与槽连接的语法要求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-QSlider%EF%BC%88%E6%BB%91%E5%9D%97%EF%BC%89-QSpinBox%EF%BC%88%E9%80%89%E5%80%BC%E6%A1%86%EF%BC%89"><span class="nav-number">1.3.0.5.</span> <span class="nav-text">5. QSlider（滑块）&#x2F;QSpinBox（选值框）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84Qt%E7%BC%96%E7%A8%8B"><span class="nav-number">1.4.</span> <span class="nav-text">三、面向对象的Qt编程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%9F%BA%E4%BA%8E%E5%AF%B9%E8%B1%A1%E7%9A%84Qt%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B9%8B%E5%89%8D%E7%9A%84%E7%BC%96%E5%86%99%E6%96%B9%E5%BC%8F%EF%BC%89-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="nav-number">1.4.0.1.</span> <span class="nav-text">1. 基于对象的Qt编程（之前的编写方式）&#x2F;&#x2F;不推荐</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84Qt%E7%BC%96%E7%A8%8B"><span class="nav-number">1.4.0.2.</span> <span class="nav-text">2. 面向对象的Qt编程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81qt%E8%AE%BE%E8%AE%A1%E5%B8%88%E4%BD%BF%E7%94%A8%EF%BC%88designer%EF%BC%89"><span class="nav-number">1.5.</span> <span class="nav-text">四、qt设计师使用（designer）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81Qt%E5%88%9B%E9%80%A0%E5%99%A8%E4%BD%BF%E7%94%A8%EF%BC%88qtcreator%EF%BC%89"><span class="nav-number">1.6.</span> <span class="nav-text">五、Qt创造器使用（qtcreator）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E8%B5%84%E6%BA%90%E5%92%8C%E5%9B%BE%E5%83%8F"><span class="nav-number">1.7.</span> <span class="nav-text">六、资源和图像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E7%9B%AE%E5%BD%95%EF%BC%88QDir%EF%BC%89%E5%92%8C%E5%AE%9A%E6%97%B6%E5%99%A8%EF%BC%88QTime%EF%BC%89"><span class="nav-number">1.8.</span> <span class="nav-text">七、目录（QDir）和定时器（QTime）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E9%BC%A0%E6%A0%87%E5%92%8C%E9%94%AE%E7%9B%98"><span class="nav-number">1.9.</span> <span class="nav-text">八、鼠标和键盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B9%9D%E3%80%81Qt%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%88QThread%EF%BC%89"><span class="nav-number">1.10.</span> <span class="nav-text">九、Qt多线程（QThread）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E3%80%81Qt%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.11.</span> <span class="nav-text">十、Qt数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%B8%80%E3%80%81Qt%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B"><span class="nav-number">1.12.</span> <span class="nav-text">十一、Qt网络编程</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">斜杠青年Felix</p>
  <div class="site-description" itemprop="description">优秀是一种态度</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">斜杠青年Felix</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
